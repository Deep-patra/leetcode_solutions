#include <bits/stdc++.h>
using namespace std;

int find(vector<int> &parents, int i) {

  if (parents[i] != i)
    return parents[i] = find(parents, parents[i]);

  return i;
}

int unite(vector<int> &parents, vector<int> &sizes, int i, int j) {

  int p1 = find(parents, i), p2 = find(parents, j);

  if (p1 == p2)
    return p1;

  if (sizes[p1] < sizes[p2]) {
    parents[p1] = p2;
    sizes[p2] += sizes[p1];

    return parents[p1];
  } else if (sizes[p1] > sizes[p2]) {
    parents[p2] = p1;
    sizes[p1] += sizes[p2];

    return parents[p2];
  } else {
    if (p1 < p2) {
      parents[p1] = p2;
      sizes[p1] += sizes[p2];

      return parents[p1];
    } else {
      parents[p2] = p1;
      sizes[p2] += sizes[p1];

      return parents[p2];
    }
  }

  return parents[p1];
}

int min_malware_spread(vector<vector<int>> &graph, vector<int> &initial) {

  int n = graph.size(), max_size = 0;

  vector<int> parents(n, -1), sizes(n, 1);

  for (int i = 0; i < n; i++)
    parents[i] = i;

  for (int i = 0; i < n; i++) {
    for (int j = 0; j < n; j++) {

      if (graph[i][j]) {
        int p = unite(parents, sizes, i, j);
      }
    }
  }

  int res = initial[0];
  for (int node : initial) {
    if (max_size < sizes[find(parents, node)]) {
      res = node;
      max_size = sizes[find(parents, node)];
    }
  }

  return res;
}

int main() {
  int t;
  cin >> t;

  while (t > 0) {
    t--;

    int n;
    cin >> n;

    vector<vector<int>> graph(n, vector<int>(n));

    for (int i = 0; i < n; i++)
      for (int j = 0; j < n; j++)
        cin >> graph[i][j];

    int m;
    cin >> m;

    vector<int> initial(m);
    for (int i = 0; i < m; i++)
      cin >> initial[i];

    int node = min_malware_spread(graph, initial);
    cout << node << endl;
  }

  return 0;
}
